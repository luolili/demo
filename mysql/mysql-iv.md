1. 为什么 索引结构用 B+树？

mysql 索引 有2类结构：hash 和 B+。

hash 索引用于 内存表，断电就会消失，适合k-v的快速查询单个记录，不适合范围查询和排序。

为什么 平衡二叉树不适合做索引？

他是逻辑上的平衡二叉树，其实现是基于数组的，在逻辑机构上相近的２个节点，在数组上可能相差很远，因此，每次读取磁盘上的数据可能很多用不上，造成很多的磁盘读取操作。

Ｂ树适合做索引，他利用了磁盘预读原理。

磁盘预读原理：磁盘不会按需读取数据，而是会读取一个需要的数据周围数据。局部性原理：当一个数据被用到时，他附近的数据也会马上被用到。

红黑树／平衡二叉树的特点：在逻辑机构上相近的２个节点，在数组上可能相差很远。

Ｂ树的查询主要发生在内存。

Ｂ树：有序数组＋平衡多叉树，不支持范围查询

Ｂ＋树：有序数组链表＋平衡多叉树
##数据库隔离级别
1.读未提交：事务b 读取的是事务a还未提交的数据（脏读）  
2.读提交：事务b 读取的是事务a已经提交的数据（不可重复读）  
3.重复读：事务b 在读的时候，不允许其他事务修改 数据（mysql 默认，幻读）  
4.序列化：事物顺序执行
##什么时候用表锁，行锁？
锁在网络数据传输很重要，在多用户操作的情况下保证数据的完整和一致性。  
当插入数据时，就锁表，当更新数据的时候就锁行。  
行锁是基于索引加载的（在命中索引的时候，被锁定的记录不可被其他事务访问）：select * from user_money where email='fg''  
email 是普通索引，会出现死锁，降低锁冲突。  
表锁：处理并发问题。事务隔离级别为串行化的时候，读写数据都会锁住表。他响应的是非索引字段，也就是全表扫描。不会出现死锁，会提高锁冲突
##分库分表后如何查询
引入分库分表 的中间件，如 mycat,sharding-jdbc.  
如何跨库表查询？分布式事务？

>mycat原理：拦截sql语句，分析sql语句（分片（分到不同的数据库），路由分析，读写分离分析，缓存分析，数据源分析），发给对应的数据源；mycat接收返回的结果

例子：  
订单表：分为三个数据库存储；根据订单不同的来源分，上海的订单放db01,北京的订单放db02,重庆的订单放db03.  
select * from order where prov=''bj'